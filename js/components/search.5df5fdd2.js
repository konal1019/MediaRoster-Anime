import{status,initSlideshow,initFlashcardHover,randomAnime,initFilters,renderGenres,initSearch,applyFilters}from"../main.84fb288e.js";import{searchAnime,getTopRatedAnime,getMostPopularAnime,getGenres,genres}from"../api.c847ee31.js";import{createSection,createFlashcard}from"./UIs.c6db23a0.js";import{loadCSS,showLoader,hideLoader}from"../pages.669bc5c1.js";import{getSafeParams}from"./utils.af173b93.js";export async function loadSearchPage(){const t=window.location.hash;loadCSS("./css/search.e2667b0c.css"),console.log("Loading Search Page"),document.getElementById("navsearch").style.color="#8960ff",document.getElementById("navhome").style.color="#ddd","{}"===JSON.stringify(genres)&&getGenres();document.getElementById("content").innerHTML='\n    <h1 class="search-title">Search across our databases and make your pick!</h1>\n    <div class="search-container">\n        <div class="search-bar">\n            <button class="filter-button"><i class="fas fa-filter"></i> Filters</button>\n            <div class="search-bar-content">\n                <input type="text" id="search-input" placeholder="Search for anime...">\n                <button id="search-button"><i class="fas fa-search"></i></button>\n            </div>\n        </div>\n        <div class="filter-options" style="display: none;">\n            <h2 class=\'filter-title\'>Filter Options</h2>\n            <div class="filter-section">\n                <div class="filter-controls">\n                    <h4 class="filter-header">Type:</h4>\n                    <div class="filter-buttons">\n                        <button class="filter-btn" data-filter="type" data-value="tv">TV</button>\n                        <button class="filter-btn" data-filter="type" data-value="movie">Movie</button>\n                        <button class="filter-btn" data-filter="type" data-value="ova">OVA</button>\n                        <button class="filter-btn" data-filter="type" data-value="special">Special</button>\n                        <button class="filter-btn" data-filter="type" data-value="ona">ONA</button>\n                        <button class="filter-btn" data-filter="type" data-value="music">Music</button>\n                    </div>\n                </div>\n            </div>\n            <div class="filter-section">\n                <div class="filter-controls">\n                    <h4 class="filter-header">Status:</h4>\n                    <div class="filter-buttons">\n                        <button class="filter-btn" data-filter="status" data-value="airing">Airing</button>\n                        <button class="filter-btn" data-filter="status" data-value="complete">Completed</button>\n                        <button class="filter-btn" data-filter="status" data-value="upcoming">Upcoming</button>\n                    </div>\n                </div>\n            </div>\n            <div class="filter-section">\n                <div class="filter-controls">\n                    <h4 class="filter-header">Rating:</h4>\n                    <div class="filter-buttons">\n                        <button class="filter-btn" data-filter="rating" data-value="g">G - All Ages</button>\n                        <button class="filter-btn" data-filter="rating" data-value="pg">PG - Children</button>\n                        <button class="filter-btn" data-filter="rating" data-value="pg13">PG-13 - Teens 13+</button>\n                        <button class="filter-btn" data-filter="rating" data-value="r17">R - 17+ (violence)</button>\n                        <button class="filter-btn" data-filter="rating" data-value="r">R+ - Mild Nudity</button>\n                        <button class="filter-btn" data-filter="rating" data-value="rx">Rx - Hentai</button>\n                    </div>\n                </div>\n            </div>\n            <div class="filter-section">\n                <div class="filter-controls">\n                    <h4 class="filter-header">Score:</h4>\n                    <input type="number" class="filter-input" placeholder="Min Score" id="min_score" min="0" max="10" step="0.1">\n                    <input type="number" class="filter-input" placeholder="Max Score" id="max_score" min="0" max="10" step="0.1">\n                </div>\n            </div>\n            <div class="filter-section">\n                <div class="filter-controls">\n                    <h4 class="filter-header">Season:</h4>\n                    <div class="filter-buttons">\n                        <button class="filter-btn" data-filter="season" data-value="winter">Winter</button>\n                        <button class="filter-btn" data-filter="season" data-value="spring">Spring</button>\n                        <button class="filter-btn" data-filter="season" data-value="summer">Summer</button>\n                        <button class="filter-btn" data-filter="season" data-value="fall">Fall</button>\n                    </div>\n                </div>\n            </div>\n            <div class="filter-section">\n                <h4 class="filter-header">Genres:</h4>\n                <div class= "filter-buttons" id="genresDiv">\n                </div>\n            </div>\n            <div class="filter-section">\n                <div class="filter-controls">\n                    <h4 class="filter-header">Order By:</h4>\n                    <select id="order_by" class="filter-dropdown">\n                        <option value="score">Score</option>\n                        <option value="members">Members</option>\n                        <option value="popularity">Popularity</option>\n                        <option value="title">A-Z</option>\n                        <option value="favorites">Favorites</option>\n                        <option value="episodes">Episodes</option>\n                    </select>\n                    <h4 class="filter-header">Sort Direction:</h4>\n                    <select id="sort" class="filter-dropdown">\n                        <option value="desc">Descending</option>\n                        <option value="asc">Ascending</option>\n                    </select>\n                </div>\n            </div>\n            <div class="sfw-toggle">\n                <label class="switch">\n                    <input type="checkbox" id="sfw-checkbox" checked>\n                    <span class="slider round"></span>\n                </label>\n                <span>Allow NSFW content</span>\n            </div>\n        </div>\n    </div>\n    <div id="search-results"></div>\n    ',showLoader(),initSearch(),initFilters();const[e,n]=t.split("?");if("#/search"!==e||n){console.log(`Search initiated with query: ${n}`);const e=document.getElementById("gridGallery");if(e&&(e.innerHTML=""),status.searching)renderGenres(),randomAnime();else{if(status.searching=!0,"#/search"!==t.split("?")[0])return;await renderGenres(),initSearch(),randomAnime(),hideLoader(),status.searching=!1}}else{const e=await searchAnime("https://api.jikan.moe/v4/anime?page=1");if("#/search"!==t)return;displaySearchResults(e);const n=document.getElementById("search-results");if(n){if("#/search"!==t)return;const e=await createSection({title:"Top Rated Anime",apiFunction:getTopRatedAnime,cardType:"top-rated",containerClass:"airing-container",titleClass:"airing-title",galleryClass:"gridGallery"});if("#/search"!==t)return;if(n.insertAdjacentHTML("beforeend",e),"#/search"!==t)return;const a=await createSection({title:"Most Popular Anime",apiFunction:getMostPopularAnime,cardType:"most-popular",containerClass:"airing-container",titleClass:"airing-title",galleryClass:"gridGallery"});if("#/search"!==t)return;n.insertAdjacentHTML("beforeend",a)}"#/search"===t&&(initFlashcardHover(),document.getElementById("randomDiv").style.display="block",renderGenres(),randomAnime(),hideLoader())}}function loadPagination(t,e){if(!e)return;e.innerHTML="";const{current_page:n,last_visible_page:a,has_next_page:i}=t,s=(t,e,n)=>{const a=document.createElement("button");return a.innerHTML=t,a.disabled=!n,n&&a.addEventListener("click",()=>{const t=getSafeParams();t.set("page",e);const n=`#/search?${t.toString()||`page=${e}`}`;window.location.hash=n}),a};e.appendChild(s("<<",1,n>1)),e.appendChild(s("<",n-1,n>1));const r=document.createElement("span");r.textContent=n,e.appendChild(r),e.appendChild(s(">",n+1,i)),e.appendChild(s(">>",a,n<a))}export async function displaySearchResults(t){const e=document.getElementById("search-results");if(!e)return;e.innerHTML="";const n=document.getElementById("default-search-content");if(n&&(n.style.display="none"),!t?.data?.length)return e.innerHTML='<p class="no-results">No Matching results found.</p>',status.searching=!1,void hideLoader();const a=document.createElement("h2");a.className="search-results-info",a.textContent=`Found ${t.pagination.items.total} anime in database`,e.appendChild(a);const i=document.createElement("div");i.className="gridGallery",i.innerHTML=t.data.map(t=>createFlashcard(t,"top-rated")).join(""),e.appendChild(i);const s=document.createElement("div");s.className="pagination-controls",e.appendChild(s),initFlashcardHover(),loadPagination(t.pagination,s)}