export function createFlashcard(a,s){const i=a.images?.webp?.image_url??"placeholder.png",e=a.title_english||a.title,l=escapeHTML(a.synopsis||a.background||"No synopsis available."),n=`#/details-${a.mal_id}`;let d=a.studios?.map(a=>a.name).join(", ")||"Unknown";d=d.length<20?d:d.slice(0,20)+"...";const r=a.genres?.map(a=>a.name).join(", ")||"Unknown";let c="",t="";switch(s){case"top-rated":c=`\n              <div class="flashcard-episodes"><i class="fas fa-play-circle"></i> ${a.episodes||"N/A"} episodes</div>\n              <div class="flashcard-status"><i class="fas fa-tv"></i> ${a.status||"Unknown"}</div>\n          `,t=`\n              <div class="flashcard-rank">#${a.rank||""}</div>\n              <div class="flashcard-rating"><i class="fas fa-star"></i> ${a.score||"N/A"}</div>\n              <div class="flashcard-type"><i class="fas fa-video"></i> ${a.type||"N/A"}</div>\n          `;break;case"most-popular":c=`\n              <div class="flashcard-episodes"><i class="fas fa-play-circle"></i> ${a.episodes||"N/A"} episodes</div>\n              <div class="flashcard-status"><i class="fas fa-tv"></i> ${a.status||"Unknown"}</div>\n          `,t=`\n              <div class="flashcard-rank">#${a.popularity||""}</div>\n              <div class="flashcard-rating"><i class="fa-solid fa-user-group"></i>${a.members?.toLocaleString()||"N/A"}</div>\n              <div class="flashcard-type"><i class="fas fa-video"></i> ${a.type||"N/A"}</div>\n          `;break;case"airing":c=`\n              <div class="flashcard-studio"><i class="fa-solid fa-clapperboard"></i>${d}</div>\n              <div class="flashcard-status"><i class="fas fa-calendar-days"></i> ${a.broadcast?.string||"Unscheduled"}</div>\n          `,t=`\n              <div class="flashcard-rank">#${a.rank||""}</div>\n              <div class="flashcard-rating"><i class="fas fa-star"></i> ${a.score||"N/A"}</div>\n              <div class="flashcard-type"><i class="fas fa-video"></i> ${a.type||"N/A"}</div>\n          `;break;case"seasonal":c=`\n              <div class="flashcard-episodes"><i class="fas fa-play-circle"></i> ${a.episodes||"N/A"} episodes</div>\n              <div class="flashcard-studio"><i class="fa-solid fa-clapperboard"></i>${d}</div>\n          `,t=`\n              <div class="flashcard-rank">#${a.rank||""}</div>\n              <div class="flashcard-rating"><i class="fas fa-star"></i> ${a.score||"N/A"}</div>\n              <div class="flashcard-type"><i class="fas fa-video"></i> ${a.type||"N/A"}</div>\n          `}return`\n      <a href="./${n}" class="flashcard-link" data-synopsis="${l}" data-type="${a.type}" data-title="${e}" data-popularity="${a.popularity}" data-rank="${a.rank}" data-score="${a.score}" data-status="${a.status}" data-genres="${r}" data-episodes="${a.episodes}" data-studios="${d}" data-rating="${a.rating}">\n          <div class="flashcard">\n              <img src="${i}" loading="lazy" alt="${e}" class="flashcard-image" width="225" height="320" loading="lazy">\n              <div class="flashcard-overlay">\n                  <div class="flashcard-title">${e}</div>\n                  ${c}\n              </div>\n              ${t}\n          </div>\n      </a>\n  `}export async function createSection({title:a,apiFunction:s,cardType:i,containerClass:e,titleClass:l,galleryClass:n}){try{const d=await s();if(!d||0===d.length)return`<div class="${e}"><h2 class="${l}">${a}</h2><p>No anime found for this category.</p></div>`;const r=d.map(a=>createFlashcard(a,i)).join("");return"horizontal-gallery"===n?`\n            <div class="${e}">\n                <h2 class="${l}, floating-header">${a}</h2>\n                <div class="gallery-prev">&lt</div>\n                <div class="${n}">\n                    ${r}\n                </div>\n                <div class="gallery-next">&gt</div>\n            </div>\n            </div>\n        `:`\n            <div class="${e}">\n                <h2 class="${l}, floating-header">${"seasonal"===i?`${a} (${d[0].season}, ${d[0].year})`:a}</h2>\n                <div class="${n}">\n                    ${r}\n                </div>\n            </div>\n        `}catch(s){return console.error(`Failed to load ${a}:`,s),`<div class="error">Failed to load ${a}. Please try again later.</div>`}}export function escapeHTML(a){return"string"!=typeof a?"":a.replace(/[&<>"'`=\/]/g,a=>{switch(a){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#039;";case"`":return"&#096;";case"=":return"&#x3D;";case"/":return"&#x2F;";default:return a}})}