export function escapeHTML(e){return"string"!=typeof e?"":e.replace(/[&<>"'`=\/]/g,e=>{switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#039;";case"`":return"&#096;";case"=":return"&#x3D;";case"/":return"&#x2F;";default:return e}})}const allowed_filters=new Set(["q","page","genres","min_score","max_score","status","type","rating","order_by","sort","sfw"]),ENUMS={status:new Set(["airing","complete","upcoming"]),type:new Set(["tv","movie","ova","special"]),rating:new Set(["g","pg","pg13","r","r17","rx"]),order_by:new Set(["title","score","popularity","favorites","members","episodes"]),sort:new Set(["asc","desc"])};export function getSafeParams(){const e=new URLSearchParams(window.location.hash.split("?")[1]||"");console.log(`raw : ${e}`);const s=new URLSearchParams;for(const[t,r]of e.entries())if(allowed_filters.has(t))if("q"===t){const e=r.replace(/[^\p{L}\p{N}\s\-_.:'";|#]/gu,"").slice(0,100);s.set("q",e)}else if(["min_score","max_score"].includes(t)){const e=parseInt(r,10);Number.isFinite(e)&&e>=0&&e<=10&&s.set(t,String(e))}else if("page"===t){const e=parseInt(r,10);Number.isFinite(e)&&e>=1&&e<=1e3&&s.set(t,String(e))}else if("genres"===t){const e=r.split(",").map(e=>parseInt(e,10)).filter(e=>Number.isFinite(e)&&e>0);e.length&&s.set("genres",e.join(","))}else if("sfw"===t)s.set("sfw",r);else if(ENUMS[t]){const e=r.toLowerCase();ENUMS[t].has(e)&&s.set(t,e)}return console.log(`safe : ${s}`),s}