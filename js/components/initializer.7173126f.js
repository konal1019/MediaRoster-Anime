export const status={searching:!1,popupInit:!1};export function initSlideshow(){let e=0;const t=document.querySelectorAll(".slide"),n=document.querySelector(".prev"),s=document.querySelector(".next");let o;function i(){t.forEach(e=>e.classList.remove("active")),e>=t.length&&(e=0),e<0&&(e=t.length-1),t[e].classList.add("active")}function a(){clearInterval(o),o=setInterval(()=>{e++,i()},5e3)}n&&s&&(n.addEventListener("click",()=>{e--,i(),a()}),s.addEventListener("click",()=>{e++,i(),a()}));const l=document.querySelector(".slideshow-container");let r=0,d=0;l.addEventListener("touchstart",e=>{r=e.changedTouches[0].screenX}),l.addEventListener("touchend",t=>{d=t.changedTouches[0].screenX,d<r&&(e++,i(),a()),d>r&&(e--,i(),a())}),i(),a()}export function initFlashcardHover(){const e=document.querySelectorAll(".flashcard-link:not([data-popup-init])"),t=document.getElementById("flash-popup");let n=!1,s=!1,o=null,i=null;if(!status.popupInit){let e=null;window.addEventListener("resize",()=>{e||(e=requestAnimationFrame(()=>{e=null,!t.hidden&&o&&a(o)}))});let l=null;window.addEventListener("scroll",()=>{l||(l=requestAnimationFrame(()=>{l=null,!t.hidden&&o&&a(o)}))},!0),t.addEventListener("touchstart",e=>e.stopPropagation()),t.addEventListener("mouseenter",()=>{s=!0,i&&clearTimeout(i)}),t.addEventListener("mouseleave",e=>{s=!1,e.relatedTarget&&e.relatedTarget.closest(".flashcard-link")||o&&o.contains(e.relatedTarget)||(i=setTimeout(r,50))}),document.addEventListener("touchstart",d),document.addEventListener("click",e=>{!o||o.contains(e.target)||t.contains(e.target)||d()}),window.addEventListener("hashchange",()=>{n=!1,s=!1,e=null,l=null,i=null,o=null,d()}),status.popupInit=!0}function a(e){const n=e.getBoundingClientRect(),[s,o]=function(){const e=window.innerWidth,t=window.innerHeight,n=[];return e<300?n.push(.9*e):e<600?n.push(.7*e):e<800?n.push(.5*e):n.push(.3*e),t<300?n.push(.7*t):t<500?n.push(.55*t):t<700?n.push(.4*t):n.push(.25*t),n}(),i=.2*n.width,a=.1*n.height;window.innerWidth-n.right>s?t.style.left=n.right-i+"px":n.left>s?t.style.left=n.left-s+2*i+"px":t.style.left=window.innerWidth-s+"px",n.top>a?t.style.top=n.top-a+"px":window.innerHeight-n.bottom>a?t.style.top=n.bottom-a+"px":t.style.top=n.top+.7*window.innerHeight,t.hidden=!1,t.style.zIndex="10"}function l(e){const n=e.dataset,s=(n.title||"").length>20?n.title.slice(0,20)+"...":n.title||"";t.innerHTML=`\n        <span id="flash-popup-rank">#${n.rank||"N/A"}</span>\n        <span id="flash-popup-title">${s}</span>\n        <span class="flash-popup-status">- ${n.status||"Unknown"}</span>\n        <div id="flash-popup-meta">\n          <div><i class="fas fa-star"></i> ${n.score||"N/A"}</div>\n          <div><i class="fas fa-video"></i> ${n.type||"N/A"}</div>\n          <div><i class="fa-solid fa-user-group"></i> ${n.popularity||"N/A"}</div>\n        </div>\n        <p id="flash-popup-synopsis">${n.synopsis||""}</p>\n        <p id="flash-popup-genres"><span>Genres: </span>${n.genres||"N/A"}</p>\n        <p id="flash-popup-episodes">${n.episodes?"<span>Episodes: </span>"+n.episodes:""}</p>\n        <p id="flash-popup-studios"><span>Studios: </span>${n.studios||"Unknown"}</p>\n        <p id="flash-popup-rating"><span>Rating: </span>${n.rating||"N/A"}</p>\n      `,a(e)}function r(){n||s||d()}function d(){o=null,t.hidden=!0,t.innerHTML="",t.style.left="",t.style.top="",t.style.zIndex="-10"}e.forEach(e=>{"true"!=e.dataset.popupInit&&(e.dataset.popupInit="true",e.addEventListener("mouseenter",()=>{i&&clearTimeout(i),n=!0,o=e,l(e)}),e.addEventListener("mouseleave",e=>{n=!1,t.contains(e.relatedTarget)||(i=setTimeout(r,50))}),e.addEventListener("touchstart",t=>{t.stopPropagation(),l(e)}))})}export function initGalleryControls(){const e=document.querySelectorAll(".gallery-prev"),t=document.querySelectorAll(".gallery-next");e.forEach(e=>{e.addEventListener("click",()=>{const t=e.parentElement.querySelector(".horizontal-gallery");t&&t.scrollBy({left:-400,behavior:"smooth"})})}),t.forEach(e=>{e.addEventListener("click",()=>{const t=e.parentElement.querySelector(".horizontal-gallery");t&&t.scrollBy({left:400,behavior:"smooth"})})})}export function randomAnime(){document.getElementById("random-anime-button").addEventListener("click",()=>{Math.floor(100*Math.random())<1?triggerJumpscare():window.location.hash="#/details-random"})}function triggerJumpscare(){const e=document.querySelector("header"),t=document.querySelector("main"),n=document.querySelector("footer"),s=document.getElementById("loader");e&&(e.style.display="none"),t&&(t.style.display="none"),n&&(n.style.display="none"),s&&(s.style.display="none");const o=document.createElement("div");o.id="jumpscare-container";const i=document.createElement("img");i.src="./media/jumpscare.jpg",i.id="jumpscare-image";const a=new Audio("./media/jumpscare.mp3");o.appendChild(i),document.body.appendChild(o),o.requestFullscreen&&o.requestFullscreen(),a.play().catch(e=>console.error("Couldn't play jumpscare audio, maybe it's missing?")),setTimeout(()=>{document.exitFullscreen&&document.exitFullscreen(),o.remove(),window.location.href="./"},3e3)}